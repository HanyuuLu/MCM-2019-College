# 计算拟合过程

# 方案

线性回归

## 数据类型

X向量

$X=[""营业收入（元）","归母净利润（元）","净资产收益率（\%）","年成交量（股）","年平均换手率（\%）","年成交额（元）]$

Y向量

$Y = 市销率（倍数）$

## 数据排列

拟合时随机打乱数据进行无序拟合

## 数据清洗

删除所有任意字段含0的记录

# 回归方法

## 待拟合数据

每个字段的$\omega$和 $b$。

$\omega = [\omega_0,\omega_1,\omega_2,\omega_3,\omega_4,\omega_5]$

## 计算流程

1. 将每个字段数据进行**归一化**处理，归一化可以归纳统一样本的统计分布性

   记为$x_0 = f_{normalization}(x)$

2. 使用$$Sigmoid$$函数处理每个字段

   $$f_{sigmoid}(x)=\frac{1}{1+e^{-x}}$$

   $x_1 = f_{sigmoid}(x_0)$

3. 计算预测值

   $\hat y = \omega \cdot x + b$

   $\hat y = [\omega_0,\omega_1,\omega_2,\omega_3,\omega_4,\omega_5]  \cdot [x_0,x_1,x_2,x_3,x_4,x_5]^T+b$

4. 以整个数据集为单位计算$\hat y $和$y$的均方误差（mse），作为误差

5. 对上述计算链求导，随机选择$\omega_i$和$b$根据梯度（导数）的反向加上一个$f’(x)\times learningRate$  的值，更新这个参数

6. 重复此过程直至误差保持稳定

   

# 结果

## 国区数据

```
10739/10739 [==============================] - 1s 57us/step
test cost: 5502344.004747227
Weights= [[ 66.15654 ]
 [ 14.219679]
 [ 27.266802]
 [615.7824  ]
 [ 63.05233 ]] 
biases= [-32.356236]
```

![1565966022828](计算拟合过程/1565966022828.png)

## 美区数据

```
13104/13104 [==============================] - 1s 53us/step
test cost: 7920354.2791549815
Weights= [[320.19235 ]
 [484.3381  ]
 [161.79457 ]
 [ 97.094376]
 [-88.09483 ]] 
biases= [-90.2469]
```

![1565976538287](计算拟合过程/1565976538287.png)